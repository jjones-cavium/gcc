2012-07-23  Andrew Pinski  <apinski@caviumnetworks.com>

	* testsuite/gcc.dg/tree-ssa/phi-opt-pass-order.c: New testcase.

2012-07-23  Adam Nemet  <anemet@caviumnetworks.com>
            Andrew Pinski  <apinski@caviumnetworks.com>

        * c-typeck.c (build_function_call): Issue an error rather than
        a warning when function is called through a non-compatible
        type and the program would abort at run-time.
	* testsuite/gcc.c-torture/execute/call-trap-1.c: Remove testcase.
	* testsuite/gcc.dg/call-diag-2.c: Update the testcase for the error
	instead of warning.
	* testsuite/gcc.dg/cast-function-1.c: Likewise.
	* testsuite/gcc.dg/invalid-call-1.c: Likewise.

2012-07-20  Adam Nemet  <anemet@caviumnetworks.com>

	* testsuite/gcc.dg/octeon/test-backtrace.h: New header.

2012-07-20  Andrew Pinski  <apinski@caviumnetworks.com>

        Bug #2942
        * config/mips/mips.md (*popcountdi2_trunc): New pattern
        to handle popcount pf a truncation.
	* testsuite/gcc.target/mips/octeon-pop-2.c: New testcase.

2012-07-20  Andrew Pinski  <apinski@caviumnetworks.com>

        Bug #380
        * config/mips/mips.c (mips_expand_ext_as_unaligned_load): Handle
        unaligned loads of 16bits too.
	* testsuite/gcc.target/mips/unaligned-2.c: New testcase.

2012-07-20  Andrew Pinski  <apinski@cavium.com>

	Bug #2056
	* config/mips/mips-protos.h (mips_expand_ext_as_unaligned_load):
	Add a bool argument.
	* config/mips/mips.c (mips_block_move_straight): Update call to
	mips_expand_ext_as_unaligned_load.
	(mips_expand_ext_as_unaligned_load): Add unsigned_p argument.
	Accept DImode dest when the width is that of SImode.
	* testsuite/gcc.target/mips/unaligned-1.c: New testcase.
	* testsuite/gcc.target/mips/mips.exp (mips_option_groups):
	Add octeon-useun.

2012-07-19  Adam Nemet  <anemet@caviumnetworks.com>

	* testsuite/gcc.dg/octeon/README: New file about this directory.

2012-07-19  Adam Nemet  <anemet@caviumnetworks.com>

	* testsuite/gcc.dg/octeon/cvmx/octeon-cvmx.exp: New file.
	* testsuite/gcc.dg/octeon/cvmx/bt-1.c: New test.
	* testsuite/gcc.dg/octeon/cvmx/bt-2.c: New test.
	* testsuite/gcc.dg/octeon/cvmx/bt-3.c: New test.
	* testsuite/gcc.dg/octeon/cvmx/bt-4.c: New test.
	* testsuite/gcc.dg/octeon/cvmx/bt-5.c: New test.

2012-07-19  Andrew Pinski  <apinski@cavium.com>

        * testsuite/gcc.target/mips/mips.exp (mips_option_tests): New test.
	(mips-dg-options): Treat all
	cases of -mhard-float as not being able to compile.

2012-07-19  Andrew Pinski  <apinski@cavium.com>
            Adam Nemet  <anemet@caviumnetworks.com>
            Chandrakala Chavva  <cchavva@caviumnetworks.com>

	* config.gcc (mips64*-*-linux* | mipsisa64*-*-linux*): Handle
	mips64*-octeon-linux* as defaulting to n64.
	Also handle mips64*-octeon-linux* like mips64octeon*-*-linux*.
	(mipsisa64-octeon-elf*): New target.
	* config/mips/mips-protos.h (mips_cvmx_shared_decl_p): New prototype.
	(octeon_output_shared_variable): New prototype.
	(mips_output_aligned_bss): New prototype.
	* config/mips/mips.c (accept_var_decls_only): New function.
	(mips_attribute_table): Add cvmx_shared and cvmx_noshared.
	(mips_merge_decl_attributes): Warn about when cvmx_shared are
	different between the two decls.
	(mips_expand_ext_as_unaligned_load): Handle the ISA_HAS_UL_US case.
	(mips_expand_ins_as_unaligned_store): Likewise.
	(mips_cvmx_shared_decl_p): New function.
	(mips_in_small_data_p): Check for cvmx_shared.
	(mips_option_override): Error out if the target is octeon* and
	hardfloat was enabled.
	Enable k0 optimization for TLS for Octeon1.
	(octeon_select_section): New function.
	(octeon_unique_section): New function.
	(octeon_output_shared_variable): New function.
	* config/mips/mips.h (ISA_HAS_UL_US): New macro.
	* config/mips/mips.md (UNSPEC_UNALIGNED_LOAD,
	UNSPEC_UNALIGNED_STORE): New unspecs.
	(mov_<load>l, mov_<load>r, mov_<store>l, mov_<store>r): Disable if
	ISA_HAS_UL_US.
	(mov_u<load>, mov_u<store>): New patterns.
	(tls_get_tp_<mode>): Emit "move $v1,$k0"
	instead of "rdhwr $v1,$29" when TARGET_TLS_ACCEL is true.
	Set can_delay to yes when TARGET_TLS_ACCEL is true.
	* config/mips/mips.opt (mtls-accel): New option.
	(mocteon-useun): New option.
	(mshared-variables): New option.
	* defaults.h (GCOV_TARGET_SUFFIX_LENGTH): Define if not already defined.
	* config/mips/octeon-elf.h: New file.
	* config/mips/octeon-linux.h: New file.
	* config/mips/octeon.h: New file.
	* config/mips/t-octeon-elf: New file.
	* config/mips/t-octeon-linux: New file.
	* testsuite/gcc.dg/octeon/pipeline-1.c: New file.
	* testsuite/gcc.dg/octeon/pipeline-2.c: New file.
	* testsuite/gcc.dg/octeon/pop-1.c: New file.
	* testsuite/gcc.dg/octeon/pop-2.c: New file.
	* testsuite/gcc.dg/octeon/saa-1.c: New file.
	* testsuite/gcc.dg/octeon/saa-2.c: New file.
	* testsuite/gcc.dg/octeon/saa-3.c: New file.
	* testsuite/gcc.dg/octeon/saa-4.c: New file.
	* testsuite/gcc.dg/octeon/seq-1.c: New file.
	* testsuite/gcc.dg/octeon/seq-10.c: New file.
	* testsuite/gcc.dg/octeon/seq-11.c: New file.
	* testsuite/gcc.dg/octeon/seq-12.c: New file.
	* testsuite/gcc.dg/octeon/seq-13.c: New file.
	* testsuite/gcc.dg/octeon/seq-2.c: New file.
	* testsuite/gcc.dg/octeon/seq-3.c: New file.
	* testsuite/gcc.dg/octeon/seq-4.c: New file.
	* testsuite/gcc.dg/octeon/seq-5.c: New file.
	* testsuite/gcc.dg/octeon/seq-6.c: New file.
	* testsuite/gcc.dg/octeon/seq-7.c: New file.
	* testsuite/gcc.dg/octeon/seq-8.c: New file.
	* testsuite/gcc.dg/octeon/seq-9.c: New file.
	* testsuite/gcc.dg/octeon/siginfo-1.c: New file.
	* testsuite/gcc.dg/octeon/tls-1.c: New file.
	* testsuite/gcc.dg/octeon/tls-2.c: New file.
	* testsuite/gcc.dg/octeon/tls-3.c: New file.
	* testsuite/gcc.dg/octeon/tls-4.c: New file.
	* testsuite/gcc.dg/octeon/unaligned-1.c: New file.
	* testsuite/gcc.dg/octeon/unaligned-2.c: New file.
	* testsuite/gcc.dg/octeon/unaligned-3.c: New file.
	* testsuite/gcc.dg/octeon/unaligned-4.c: New file.
	* testsuite/gcc.dg/octeon/unaligned-5.c: New file.
	* testsuite/gcc.dg/octeon/unaligned-6.c: New file.
	* testsuite/gcc.dg/octeon/vrp-1.c: New file.
	* testsuite/gcc.dg/octeon/vrp-2.c: New file.
	* testsuite/gcc.dg/octeon/vrp-3.c: New file.
	* testsuite/gcc.dg/octeon/vrp-4.c: New file.
	* testsuite/gcc.dg/octeon/cvmx-shared-10.c: New file.
	* testsuite/gcc.dg/octeon/cvmx-shared-11.c: New file.
	* testsuite/gcc.dg/octeon/cvmx-shared-2.c: New file.
	* testsuite/gcc.dg/octeon/cvmx-shared-3.c: New file.
	* testsuite/gcc.dg/octeon/cvmx-shared-4.c: New file.
	* testsuite/gcc.dg/octeon/cvmx-shared-5.cc: New file.
	* testsuite/gcc.dg/octeon/cvmx-shared-6.c: New file.
	* testsuite/gcc.dg/octeon/cvmx-shared-7.c: New file.
	* testsuite/gcc.dg/octeon/cvmx-shared-8.c: New file.
	* testsuite/gcc.dg/octeon/cvmx-shared-9.c: New file.


2012-07-18  Andrew Pinski  <apinski@cavium.com>

	* cfgloop.h (exact_loop_iterations_unbounded): Add Prototype.
	* cfgloopanal.c (exact_loop_iterations_unbounded): New function.

2012-07-16  Andrew Pinski  <apinski@cavium.com>

        * tree-pass.h (pass_profile_loop_bounds): New variable.
        * timevar.def (TV_PROFILE_LOOP_BOUNDS): New time var.
        * tree-ssa-loop.c (tree_profile_loop_bounds): New function.
        (gate_profile_loop_bounds): New function.
        (pass_profile_loop_bounds): New pass.
        * passes.c (init_optimization_passes): Add pass_profile_loop_bounds before
        pass_complete_unrolli.

2012-07-16  Andrew Pinski  <apinski@cavium.com>

        * opts.c (default_options_table): Turn on
        register pressure sensitive instruction
        scheduling at -O3 and above.

2012-07-16  Adam Nemet  <anemet@caviumnetworks.com>
            Andrew Pinski  <apinski@cavium.com>

	* opts.c (default_options_table): Enable fmerge-const-bfstores at -O2.

2012-07-16  Adam Nemet  <anemet@caviumnetworks.com>
            Andrew Pinski  <apinski@cavium.com>

	* opts.c (default_options_table): Enable fpostreload-load at -O2.

2012-07-16  Adam Nemet  <anemet@caviumnetworks.com>
            Andrew Pinski  <apinski@cavium.com>

        * basic-block.h (struct basic_block_def): Add new field probability.
        * builtins.def (BUILT_IN_BLOCK_PROB): New builtin.
        * predict.def (PRED_BUILTIN_BLOCK_PROB): New predictor.
        * common.opt (flag_propagate_block_prob): New option.
        * predict.c (compute_block_prob): New function.  Set basic block
        probablity from builtin_block_prob
        (propagate_block_prob): New functions.  Propagate branch
        probabilities backward in the CFG.
        (tree_estimate_probability): Invoke them.
        (tree_predict_by_opcode): Copy BB probablity to edge.
        * builtins.c (expand_builtin): Handle BUILT_IN_BLOCK_PROB.

2012-07-16  Andrew Pinski  <apinski@cavium.com>

	* expmed.c (store_fixed_bit_field): Special case the storing
        of the whole field.

2012-07-16  Adam Nemet  <anemet@caviumnetworks.com>
            Andrew Pinski  <apinski@cavium.com>

	* postreload-load.c: New file.
	* Makefile.in (OBJS-common): Add postreload-load.o.
	(postreload-load.o): New rule.
	* common.opt (fpostreload-load): New option.
	* timevar.def: Add TV_LOAD_AFTER_RELOAD timevar.
	* tree-pass.h (pass_postreload_load): Declare.
	* passes.c (init_optimization_passes): Add
	pass_postreload_load.

2012-07-16  Adam Nemet  <anemet@caviumnetworks.com>
            Andrew Pinski  <apinski@cavium.com>

	* tree-merge-const-bfstores.c: New file.
	* Makefile.in (OBJS-common): Add tree-merge-const-bfstores.o.
	(tree-merge-const-bfstores.o): New rule.
	* timevar.def: Add TV_MERGE_CONST_BFSTORES timevar.
	* tree-pass.h (pass_merge_const_bfstores): Declare.
	* passes.c (init_optimization_passes): Add
	pass_merge_const_bfstores.
	* common.opt (fmerge-const-bfstores): New option.

2012-07-16  Andrew Pinski  <apinski@cavium.com>

	Bug #2845
	* target.h (gcc_target): Add mode_for_extraction_insv.
	* expmed.c (store_bit_field_1): Use mode_for_extraction_insv
	and split out into ...
	(store_bit_field_2): Here.
	* target-def.h (TARGET_MODE_FOR_EXTRACTION_INSV): Define.
	(TARGET_INITIALIZER): Add TARGET_MODE_FOR_EXTRACTION_INSV.
	* config/mips/mips.c (mips_mode_for_extraction_insv): New function.
	(TARGET_MODE_FOR_EXTRACTION_INSV): Define.

2012-07-16  Andrew Pinski  <apinski@cavium.com>

        start of bug #4296
        * config/mips/mips.c (mips_rtx_cost_data): Add movz cost.
	(mips_cpu_info_table): Set movz for Octeon to 2 and Octeon2 to 3.
	(mips_rtx_costs <case IF_THEN_ELSE>): Return mips_cost->movz.

2012-07-15  Andrew Pinski  <apinski@caviumnetworks.com>

        Bug #3154
        * config/mips/mips.md (bswapdi2): New instruction pattern.
        (bswapsi2): Likewise.
        * config/mips/mips.h (ISA_HAS_SBWH): New ISA define.
        * testsuite/gcc.target/mips/bswap-1.c: New test.

2012-07-15  Andrew Pinski  <apinski@cavium.com>

        Bug #4290
        * tree-vrp.c (vrp_stmt_computes_nonzero): Return true for some
        builtins (memcpy and memmove).
        (infer_value_range): Infer the nonzero for some arguments to
        some builtins (memcpy, memmove, strcmp and memcmp).
        * testsuite/gcc.dg/tree-ssa/vrp-builtins1.c: New testcase.

2012-07-15  Andrew Pinski  <apinski@cavium.com>

	* testsuite/gcc.c-torture/unsorted/dump-noaddr.x (dump_compare): Use
        an absolute dump base instead of a relative one.

2012-07-13  Andrew Pinski  <apinski@cavium.com>
 
	* opts.c (default_options_table): Enable unroll-loops at -O3 and above.

	* testsuite/gcc.target/i386/l_fma_float_5.c: Add -fno-unroll-loops.
	* testsuite/gcc.target/i386/l_fma_double_4.c: Likewise.
	* testsuite/gcc.target/i386/l_fma_float_2.c: Likewise.
	* testsuite/gcc.target/i386/l_fma_float_6.c: Likewise.
	* testsuite/gcc.target/i386/l_fma_double_1.c: Likewise.
	* testsuite/gcc.target/i386/l_fma_double_5.c: Likewise.
	* testsuite/gcc.target/i386/l_fma_float_3.c: Likewise.
	* testsuite/gcc.target/i386/l_fma_double_2.c: Likewise.
	* testsuite/gcc.target/i386/l_fma_double_6.c: Likewise.
	* testsuite/gcc.target/i386/l_fma_float_4.c: Likewise.
	* testsuite/gcc.target/i386/l_fma_double_3.c: Likewise.
	* testsuite/gcc.target/i386/l_fma_float_1.c: Likewise.
	* testsuite/gcc.target/i386/fma4-builtin-2.c: Likewise.
	* testsuite/gcc.target/i386/fma3-builtin-2.c: Likewise.

2012-07-13  Andrew Pinski  <apinski@cavium.com>

	Bug #4258
	* config/mips/mips.c (mips_delegitimize_address): New function.
	(TARGET_DELEGITIMIZE_ADDRESS): Define.

2012-07-13  Andrew Pinski  <apinski@cavium.com>
            Chandrakala Chavva  <cchavva@caviumnetworks.com>

	* config/mips/mips.opt (mfix-cn63xxp1): New option.
	* config/mips/mips.h (ASM_SPEC): Add mfix-cn63xxp1.

2012-07-13  Andrew Pinski  <apinski@cavium.com>

	Bug #4325
	* tree-pass.h (pass_merge_common_code): New declaration.
	* tree-ssa-merge-common-code.c: New file.
	* Makefile.in (OBJS): Add tree-ssa-merge-common-code.o.
	(tree-ssa-merge-common-code.o): New target.
	* passes.c (init_optimization_passes): Add pass_merge_common_code
	after the two fres and after the pre.

2012-07-13  Andrew Pinski  <apinski@cavium.com>

	* tree-ssa-phiopt.c (tree_ssa_phiopt_worker): Prop
	the phi result if value_remplacement returns 1.

2012-07-13  Andrew Pinski  <apinski@cavium.com>

        * configure.ac: Set PLUGIN_LD to just "ld" if it was "ld-new".
        * configure: Regenerate.

